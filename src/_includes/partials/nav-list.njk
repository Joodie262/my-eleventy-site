<div class="nav">
  <button class="nav-toggle" aria-expanded="false" aria-controls="site-menu">
    â˜° Menu
  </button>

  <div id="site-menu" class="nav-links">
    {% set navPages = collections.all | eleventyNavigation %}

    {% macro renderNavItem(item) %}
      {% if item.children.length %}
        <details class="nav-item"{% if item.isActive %} open{% endif %}>
          <summary>
            <!-- Toggle button for submenu -->
            <button class="nav-toggle-child" aria-label="Toggle submenu" onclick="this.closest('details').open = !this.closest('details').open; event.stopPropagation();"></button>
            <!-- Parent page link -->
            <a href="{{ item.url }}"
               class="nav-parent-link"
               {% if item.isCurrent %}aria-current="page"{% endif %}>
              {{ item.title }}
            </a>
          </summary>
          <ul class="dropdown">
            {%- for child in item.children -%}
              <li>
                <a href="{{ child.url }}"{% if child.isCurrent %} aria-current="page"{% endif %}>
                  {{ child.title }}
                </a>
              </li>
            {%- endfor -%}
          </ul>
        </details>
      {% else %}
        <a href="{{ item.url }}"{% if item.isCurrent %} aria-current="page"{% endif %}>
          {{ item.title }}
        </a>
      {% endif %}
    {% endmacro %}

    {%- for entry in navPages -%}
      {{ renderNavItem(entry) }}
      {%- if not loop.last -%}
        <span class="nav-sep">|</span>
      {%- endif -%}
    {%- endfor -%}
  </div>
</div>
<hr>
